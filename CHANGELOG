unreleased

* Enhancements

  * Add tests
  * Simply, DRY, and make thread-safe
